<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Portal do Aluno ‚Ä¢ Respect Style</title>
  <meta name="description" content="√Årea do aluno Respect Style ‚Äî hor√°rios, avisos, eventos e perfil.">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0e0e10;
      --card:#151517;
      --ring:#2a2a2e;
      --accent:#0aa30a;
      --red:#e50914;
      --white:#fff;
      --muted:#cfd0d7;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Inter',system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;background:var(--bg);color:var(--white);-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale}
    a{color:inherit;text-decoration:none}
    img{max-width:100%;display:block}

    /* Topbar */
    .topbar{
      position:sticky;top:0;z-index:40;
      display:flex;justify-content:space-between;align-items:center;
      gap:12px;padding:12px 18px;border-bottom:1px solid var(--ring);
      backdrop-filter:blur(6px);background:rgba(8,8,8,0.6);
    }
    .brand{display:flex;gap:12px;align-items:center}
    .brand img{width:44px;height:44px;border-radius:10px;border:2px solid var(--red);object-fit:cover}
    .brand .title{font-size:18px;font-weight:700}
    .brand .subtitle{font-size:12px;color:var(--muted)}

    .top-actions{display:flex;gap:8px;align-items:center}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:10px;border:1px solid var(--ring);background:transparent;color:var(--white);font-weight:700;cursor:pointer}
    .btn:hover{transform:translateY(-2px)}
    .btn.primary{background:linear-gradient(90deg,var(--accent),#00c44a);color:#041404;border:none}
    .btn.ghost{background:transparent}
    .user-pill{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;background:var(--glass);border:1px solid rgba(255,255,255,0.03)}

    /* Layout */
    .layout{display:flex;min-height:calc(100vh - 64px)}
    .sidebar{
      width:260px;min-width:220px;background:linear-gradient(180deg,#121213,#0f0f11);border-right:1px solid var(--ring);
      padding:18px;display:flex;flex-direction:column;gap:12px;
    }
    .sidebar .nav-item{padding:12px;border-radius:10px;color:var(--white);display:flex;align-items:center;gap:12px;cursor:pointer;border:1px solid transparent}
    .sidebar .nav-item:hover{background:rgba(255,255,255,0.02);transform:translateX(4px)}
    .sidebar .nav-item.active{background:linear-gradient(90deg, rgba(10,163,10,0.12), rgba(10,163,10,0.04));border-color:rgba(10,163,10,0.12)}
    .sidebar .profile{margin-top:auto;padding-top:8px;border-top:1px solid var(--ring);display:flex;gap:12px;align-items:center}

    /* Main */
    .main{flex:1;padding:22px;display:flex;flex-direction:column;gap:18px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .card{background:linear-gradient(180deg,#151518,#0f0f11);border-radius:12px;padding:16px;border:1px solid var(--ring);box-shadow:0 12px 30px rgba(0,0,0,0.45)}
    .card h3{margin:0;font-size:16px}
    .muted{color:var(--muted);font-size:13px}
    .small{font-size:13px;color:var(--muted)}
    .list{display:flex;flex-direction:column;gap:8px;margin-top:10px}

    /* schedule list */
    .session{display:flex;justify-content:space-between;gap:10px;align-items:center;padding:10px;border-radius:10px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}
    .session .left{display:flex;gap:12px;align-items:center}
    .avatar-small{width:44px;height:44px;border-radius:8px;background:#0b0b0b;display:flex;align-items:center;justify-content:center;border:1px solid var(--ring)}
    .session .meta{display:flex;flex-direction:column}
    .session .meta .title{font-weight:700}
    .session .meta .time{font-size:13px;color:var(--muted)}
    .attendance{display:flex;gap:8px;align-items:center}

    /* notices/events */
    .notice{padding:12px;border-radius:10px;background:linear-gradient(180deg,#0f1112,#0b0b0c);border:1px solid var(--ring)}
    .notice .date{font-size:12px;color:var(--muted)}
    .event-list{display:flex;flex-direction:column;gap:10px;margin-top:8px}

    /* profile */
    .profile-grid{display:grid;grid-template-columns:1fr 2fr;gap:12px}
    .profile-card{display:flex;flex-direction:column;gap:10px;align-items:center;text-align:center}
    .profile-card img{width:96px;height:96px;border-radius:14px;border:2px solid var(--accent);object-fit:cover}
    .input{width:100%;padding:10px;border-radius:8px;border:1px solid var(--ring);background:#0b0b0b;color:var(--white)}

    /* responsive */
    @media(max-width:980px){
      .grid{grid-template-columns:repeat(2,1fr)}
      .sidebar{width:220px}
    }
    @media(max-width:760px){
      .layout{flex-direction:column}
      .sidebar{order:2;width:100%;min-width:unset;display:flex;flex-direction:row;overflow:auto;padding:10px}
      .sidebar .nav-item{flex:0 0 auto}
      .main{order:1;padding:14px}
      .grid{grid-template-columns:1fr}
      .profile-grid{grid-template-columns:1fr}
    }

    /* tiny helpers */
    .row{display:flex;gap:12px;align-items:center}
    .chip{padding:8px 10px;border-radius:999px;background:rgba(255,255,255,0.02);font-weight:700}
    .muted-block{color:var(--muted);font-size:13px}
    .link{color:var(--accent);cursor:pointer}
    .hidden{display:none}
  </style>
</head>
<body>
  <!-- Topbar -->
  <div class="topbar" role="banner">
    <div class="brand" aria-hidden="false">
      <img src="../imagens/logo-respect.png" alt="Respect Style" onerror="this.onerror=null;this.src='https://via.placeholder.com/100x100?text=Logo'">
      <div>
        <div class="title">Respect Style</div>
        <div class="subtitle">Portal do Aluno</div>
      </div>
    </div>

    <div class="top-actions" role="navigation" aria-label="A√ß√µes">
      <button class="btn ghost" id="openShopBtn" title="Abrir Loja">Loja</button>
      <button class="btn ghost" id="openSupport" title="Suporte">Suporte</button>
      <div id="authArea"></div>
    </div>
  </div>

  <!-- Layout -->
  <div class="layout" role="main">
    <!-- Sidebar -->
    <aside class="sidebar" aria-label="Navega√ß√£o">
      <div style="display:flex;flex-direction:column;gap:6px;">
        <div class="nav-item active" data-view="dashboard"><span>üè†</span> Dashboard</div>
        <div class="nav-item" data-view="schedule"><span>üìÖ</span> Hor√°rios</div>
        <div class="nav-item" data-view="notices"><span>üì¢</span> Avisos</div>
        <div class="nav-item" data-view="events"><span>üéüÔ∏è</span> Eventos</div>
        <div class="nav-item" data-view="profile"><span>üë§</span> Perfil</div>
      </div>

      <div class="profile" aria-hidden="false">
        <div style="display:flex;gap:12px;align-items:center">
          <div style="width:54px;height:54px;border-radius:10px;background:#0b0b0b;border:1px solid var(--ring);display:flex;align-items:center;justify-content:center">
            <img id="smallAvatar" src="https://via.placeholder.com/64x64?text=You" alt="avatar" style="width:48px;height:48px;border-radius:8px;object-fit:cover">
          </div>
          <div>
            <div id="sidebarName" style="font-weight:700">Convidado</div>
            <div class="small" id="sidebarEmail">N√£o autenticado</div>
          </div>
        </div>
        <div style="margin-top:10px;display:flex;gap:8px">
          <button class="btn" id="loginBtn">Login</button>
          <button class="btn" id="logoutBtn" style="display:none">Sair</button>
        </div>
      </div>
    </aside>

    <!-- Main -->
    <section class="main" id="mainContent">
      <!-- Dashboard view -->
      <div id="view-dashboard">
        <div class="grid">
          <div class="card">
            <h3>Pr√≥ximo Treino</h3>
            <div class="muted">Seu pr√≥ximo hor√°rio marcado</div>
            <div id="nextSession" style="margin-top:12px"></div>
          </div>

          <div class="card">
            <h3>Saldo / Cr√©ditos</h3>
            <div class="muted">Raspa-Coins e pagamentos</div>
            <div style="margin-top:12px">
              <div style="font-weight:800;font-size:18px">R$ <span id="userBalance">0,00</span></div>
              <div class="small" style="margin-top:6px">√öltimo pagamento: <span id="lastPayment">nenhum</span></div>
            </div>
          </div>

          <div class="card">
            <h3>Atividades Recentes</h3>
            <div class="muted">Presen√ßas e a√ß√µes</div>
            <div class="list" id="activityList" style="margin-top:10px"></div>
          </div>
        </div>

        <div style="display:flex;gap:16px;flex-wrap:wrap;margin-top:16px">
          <div class="card" style="flex:1;min-width:320px">
            <h3>Hor√°rios R√°pidos</h3>
            <div class="muted">Toque para confirmar presen√ßa</div>
            <div class="list" id="quickSchedule"></div>
          </div>

          <div class="card" style="width:380px;min-width:260px">
            <h3>Avisos Recentes</h3>
            <div class="muted">√öltimas comunica√ß√µes da academia</div>
            <div id="noticesList" style="margin-top:10px"></div>
          </div>
        </div>
      </div>

      <!-- Schedule view -->
      <div id="view-schedule" class="hidden">
        <div class="card">
          <h3>Hor√°rios da Semana</h3>
          <div class="muted">Clique em "Marcar presen√ßa" quando estiver no treino</div>
          <div class="list" id="fullSchedule" style="margin-top:12px"></div>
        </div>
      </div>

      <!-- Notices view -->
      <div id="view-notices" class="hidden">
        <div class="card">
          <h3>Avisos</h3>
          <div class="muted">Comunicados oficiais</div>
          <div class="event-list" id="allNotices" style="margin-top:12px"></div>
        </div>
      </div>

      <!-- Events view -->
      <div id="view-events" class="hidden">
        <div class="card">
          <h3>Eventos & Competi√ß√µes</h3>
          <div class="muted">Pr√≥ximas datas importantes</div>
          <div id="eventsList" style="margin-top:12px"></div>
        </div>
      </div>

      <!-- Profile view -->
      <div id="view-profile" class="hidden">
        <div class="card profile-card">
          <img id="profileAvatar" src="https://via.placeholder.com/200x200?text=Avatar" alt="avatar">
          <div style="font-weight:800" id="profileName">Convidado</div>
          <div class="muted" id="profileEmail">sem e-mail</div>
          <div style="width:100%;margin-top:12px">
            <div style="text-align:left;margin-bottom:8px"><strong>Editar Perfil</strong></div>
            <input class="input" id="inputName" placeholder="Nome completo">
            <input class="input" id="inputEmail" placeholder="E-mail" style="margin-top:8px">
            <div style="display:flex;gap:8px;margin-top:10px">
              <button class="btn primary" id="saveProfileBtn">Salvar</button>
              <button class="btn" id="changePassBtn">Alterar Senha</button>
            </div>
          </div>
        </div>

        <div class="card" style="margin-top:12px">
          <h3>Hist√≥rico de Presen√ßa</h3>
          <div class="muted">Seus √∫ltimos check-ins</div>
          <div id="attendanceHistory" style="margin-top:10px"></div>
        </div>
      </div>
    </section>
  </div>

  <!-- Login / Cadastro Modal -->
  <div id="modalBg" class="hidden" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);z-index:60">
    <div style="width:min(460px,95%);background:linear-gradient(180deg,#151517,#0f0f11);padding:18px;border-radius:12px;border:1px solid var(--ring)">
      <h3 id="modalTitle">Login</h3>
      <div style="display:flex;flex-direction:column;gap:8px;margin-top:12px">
        <input id="authEmail" class="input" type="email" placeholder="E-mail">
        <input id="authPass" class="input" type="password" placeholder="Senha">
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn primary" id="submitAuth">Entrar</button>
          <button class="btn" id="switchAuth">Criar conta</button>
          <button class="btn" id="closeModal">Fechar</button>
        </div>
      </div>
      <div style="margin-top:10px;color:var(--muted);font-size:13px">Login demo ‚Äî os dados ficam locais. Integre com Firebase/Auth posteriormente.</div>
    </div>
  </div>

  <script>
    /* ------------------------
       Demo data (seed) - voc√™ pode carregar do backend/Firebase depois
       ------------------------ */
    const demoUser = {
      name: 'Aluno Demo',
      email: 'aluno@demo.com',
      avatar: 'https://via.placeholder.com/160x160?text=Aluno',
      balance: '49.90'
    };

    const SESSIONS = [
      { id:'s1', title:'Gi - Treino Avan√ßado', time:'Seg 19:00 - 20:30', coach:'Sensei Rafael', cat:'kimonos' },
      { id:'s2', title:'NoGi - T√©cnicas', time:'Qua 19:00 - 20:30', coach:'Coach Amanda', cat:'nogi' },
      { id:'s3', title:'Infantil - Inicia√ß√£o', time:'S√°b 10:00 - 11:00', coach:'Prof. Carlos', cat:'infantil' },
      { id:'s4', title:'Open Mat', time:'Dom 09:00 - 11:00', coach:'Equipe', cat:'open' }
    ];

    const NOTICES = [
      { id:'n1', date:'2025-10-01', title:'Aula cancelada', text:'A aula de sexta foi cancelada por manuten√ß√£o.' },
      { id:'n2', date:'2025-10-05', title:'Certifica√ß√£o', text:'Novo curso de gradua√ß√£o no pr√≥ximo m√™s. Inscreva-se.' }
    ];

    const EVENTS = [
      { id:'e1', date:'2025-11-10', title:'Competi√ß√£o Estadual', location:'Gin√°sio Central' },
      { id:'e2', date:'2025-12-05', title:'Festa de Confraterniza√ß√£o', location:'Sede Respect' }
    ];

    // localStorage keys
    const LS_USER = 'respect_user_v1';
    const LS_ACTIVITY = 'respect_activity_v1';
    const LS_ATTENDANCE = 'respect_att_v1';

    /* ------------------------
       State & helpers
       ------------------------ */
    function getStoredUser(){ try { return JSON.parse(localStorage.getItem(LS_USER)) } catch(e){ return null } }
    function setStoredUser(u){ localStorage.setItem(LS_USER, JSON.stringify(u)) }
    function clearStoredUser(){ localStorage.removeItem(LS_USER) }
    function getActivity(){ try { return JSON.parse(localStorage.getItem(LS_ACTIVITY)) || [] } catch(e){ return [] } }
    function pushActivity(a){ const arr = getActivity(); arr.unshift(a); localStorage.setItem(LS_ACTIVITY, JSON.stringify(arr.slice(0,30))); }
    function getAttendance(){ try{ return JSON.parse(localStorage.getItem(LS_ATTENDANCE)) || [] }catch(e){return []} }
    function pushAttendance(a){ const arr = getAttendance(); arr.unshift(a); localStorage.setItem(LS_ATTENDANCE, JSON.stringify(arr.slice(0,50))); }

    /* ------------------------
       UI initialization
       ------------------------ */
    document.addEventListener('DOMContentLoaded', () => {
      // bind nav
      document.querySelectorAll('.sidebar .nav-item').forEach(el => el.addEventListener('click', e => {
        document.querySelectorAll('.sidebar .nav-item').forEach(x => x.classList.remove('active'));
        el.classList.add('active');
        showView(el.getAttribute('data-view'));
      }));

      // top actions
      document.getElementById('openShopBtn').addEventListener('click', () => {
        // abre loja na mesma origem; ajuste se loja estiver em outro dom√≠nio
        window.location.href = '../loja/index.html';
      });
      document.getElementById('openSupport').addEventListener('click', () => window.open('https://wa.me/5599999999999','_blank'));

      // auth area
      const authArea = document.getElementById('authArea');
      renderAuthArea();

      // login modal buttons
      document.getElementById('loginBtn').addEventListener('click', openAuthModal);
      document.getElementById('logoutBtn').addEventListener('click', logout);
      document.getElementById('closeModal').addEventListener('click', closeAuthModal);
      document.getElementById('switchAuth').addEventListener('click', toggleAuthMode);
      document.getElementById('submitAuth').addEventListener('click', handleAuthSubmit);

      // fill in dashboard
      renderDashboard();
      renderQuickSchedule();
      renderNotices();
      renderFullSchedule();
      renderEvents();
      renderProfile();
      renderAttendanceHistory();

      // set initial view
      showView('dashboard');
    });

    /* ------------------------
       Views controller
       ------------------------ */
    function showView(name){
      ['dashboard','schedule','notices','events','profile'].forEach(v => {
        document.getElementById('view-'+v).classList.toggle('hidden', v !== name);
      });
      // update main content title / analytics if needed
    }

    /* ------------------------
       Auth (demo)
       ------------------------ */
    let authMode = 'login'; // or 'signup'
    function renderAuthArea(){
      const user = getStoredUser();
      const authArea = document.getElementById('authArea');
      authArea.innerHTML = '';
      if(user){
        const pill = document.createElement('div');
        pill.className = 'user-pill';
        pill.innerHTML = `<img src="${escape(user.avatar||'https://via.placeholder.com/48?text=U')}" alt="avatar" style="width:28px;height:28px;border-radius:6px;object-fit:cover"><div style="font-weight:700">${escape(user.name||'Aluno')}</div>`;
        authArea.appendChild(pill);
        document.getElementById('loginBtn').style.display = 'none';
        document.getElementById('logoutBtn').style.display = 'inline-flex';
        // update sidebar
        document.getElementById('sidebarName').innerText = user.name || 'Aluno';
        document.getElementById('sidebarEmail').innerText = user.email || '';
        document.getElementById('smallAvatar').src = user.avatar || 'https://via.placeholder.com/64';
      } else {
        const loginBtn = document.createElement('button');
        loginBtn.className = 'btn';
        loginBtn.innerText = 'Entrar';
        loginBtn.addEventListener('click', openAuthModal);
        authArea.appendChild(loginBtn);
        document.getElementById('loginBtn').style.display = 'inline-flex';
        document.getElementById('logoutBtn').style.display = 'none';
        document.getElementById('sidebarName').innerText = 'Convidado';
        document.getElementById('sidebarEmail').innerText = 'N√£o autenticado';
        document.getElementById('smallAvatar').src = 'https://via.placeholder.com/64x64?text=?';
      }
    }

    function openAuthModal(){
      authMode = 'login';
      document.getElementById('modalTitle').innerText = 'Login';
      document.getElementById('authEmail').value = '';
      document.getElementById('authPass').value = '';
      document.getElementById('modalBg').classList.remove('hidden');
    }
    function closeAuthModal(){
      document.getElementById('modalBg').classList.add('hidden');
    }
    function toggleAuthMode(){
      authMode = (authMode === 'login') ? 'signup' : 'login';
      document.getElementById('modalTitle').innerText = (authMode === 'login') ? 'Login' : 'Criar Conta';
      document.getElementById('switchAuth').innerText = (authMode === 'login') ? 'Criar conta' : 'Tenho conta';
    }
    function handleAuthSubmit(){
      const email = document.getElementById('authEmail').value.trim();
      const pass = document.getElementById('authPass').value.trim();
      if(!email || !pass){ alert('Preencha e-mail e senha'); return; }
      // demo logic: criar uma conta local simples
      if(authMode === 'signup'){
        const newUser = { name: email.split('@')[0], email, avatar: 'https://via.placeholder.com/160x160?text=User', balance: '0.00' };
        setStoredUser(newUser);
        pushActivity({ when: Date.now(), text: 'Conta criada (demo)' });
        renderAuthArea();
        closeAuthModal();
        alert('Conta criada (demo).');
      } else {
        // login demo: se email == demoUser.email -> set demoUser, else create ephemeral
        if(email === demoUser.email && pass === 'demo'){
          setStoredUser(demoUser);
          pushActivity({ when: Date.now(), text: 'Login como Aluno Demo' });
          renderAuthArea();
          closeAuthModal();
          renderDashboard();
        } else {
          // simples: cria usu√°rio com email
          const u = { name: email.split('@')[0], email, avatar: 'https://via.placeholder.com/160x160?text=U', balance: '0.00' };
          setStoredUser(u);
          pushActivity({ when: Date.now(), text: 'Login (demo) como ' + u.name });
          renderAuthArea();
          closeAuthModal();
        }
      }
      // update profile view
      renderProfile();
    }
    function logout(){
      clearStoredUser();
      renderAuthArea();
      renderProfile();
      alert('Voc√™ saiu da conta.');
    }

    /* ------------------------
       Dashboard rendering
       ------------------------ */
    function renderDashboard(){
      // next session: pick first upcoming from SESSIONS
      const next = SESSIONS[0];
      const nextEl = document.getElementById('nextSession');
      nextEl.innerHTML = `
        <div class="session">
          <div class="left">
            <div class="avatar-small">üè∑Ô∏è</div>
            <div class="meta">
              <div class="title">${escape(next.title)}</div>
              <div class="time">${escape(next.time)} ‚Ä¢ ${escape(next.coach)}</div>
            </div>
          </div>
          <div class="attendance">
            <button class="btn" onclick="markAttendance('${next.id}')">Marcar presen√ßa</button>
          </div>
        </div>
      `;

      // activity list
      const activity = getActivity();
      const actEl = document.getElementById('activityList');
      actEl.innerHTML = '';
      if(activity.length === 0){
        actEl.innerHTML = '<div class="muted">Nenhuma atividade recente.</div>';
      } else {
        activity.slice(0,6).forEach(a => {
          const when = new Date(a.when);
          const el = document.createElement('div');
          el.className = 'small';
          el.innerText = `${when.toLocaleString()} ‚Äî ${a.text}`;
          actEl.appendChild(el);
        });
      }

      // user balance
      const user = getStoredUser();
      document.getElementById('userBalance').innerText = (user && user.balance) ? user.balance : (demoUser.balance || '0,00');
      document.getElementById('lastPayment').innerText = '‚Äî';
    }

    /* ------------------------
       Quick schedule + full schedule
       ------------------------ */
    function renderQuickSchedule(){
      const wrap = document.getElementById('quickSchedule');
      wrap.innerHTML = '';
      SESSIONS.forEach(s => {
        const el = document.createElement('div');
        el.className = 'session';
        el.innerHTML = `
          <div class="left">
            <div class="avatar-small">ü§º</div>
            <div class="meta">
              <div class="title">${escape(s.title)}</div>
              <div class="time">${escape(s.time)}</div>
            </div>
          </div>
          <div class="attendance">
            <button class="btn" onclick="markAttendance('${s.id}')">Presen√ßa</button>
            <button class="btn ghost" onclick="viewSession('${s.id}')">Ver</button>
          </div>
        `;
        wrap.appendChild(el);
      });
    }

    function renderFullSchedule(){
      const wrap = document.getElementById('fullSchedule');
      wrap.innerHTML = '';
      SESSIONS.forEach(s => {
        const el = document.createElement('div');
        el.className = 'session';
        el.innerHTML = `
          <div class="left">
            <div class="avatar-small">üè∑Ô∏è</div>
            <div class="meta">
              <div class="title">${escape(s.title)}</div>
              <div class="time">${escape(s.time)} ‚Ä¢ ${escape(s.coach)}</div>
            </div>
          </div>
          <div class="attendance">
            <button class="btn" onclick="markAttendance('${s.id}')">Marcar presen√ßa</button>
          </div>
        `;
        wrap.appendChild(el);
      });
    }

    /* ------------------------
       Notices / Events rendering
       ------------------------ */
    function renderNotices(){
      const el = document.getElementById('noticesList');
      el.innerHTML = '';
      NOTICES.slice(0,4).forEach(n => {
        const item = document.createElement('div');
        item.className = 'notice';
        item.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>${escape(n.title)}</strong><div class="small">${escape(n.text)}</div></div><div class="date muted">${escape(n.date)}</div></div>`;
        el.appendChild(item);
      });
    }

    function renderEvents(){
      const el = document.getElementById('eventsList');
      el.innerHTML = '';
      EVENTS.forEach(e => {
        const item = document.createElement('div');
        item.className = 'notice';
        item.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center"><div><strong>${escape(e.title)}</strong><div class="small">${escape(e.location)}</div></div><div class="muted">${escape(e.date)}</div></div>`;
        el.appendChild(item);
      });

      // full notices
      const allNotices = document.getElementById('allNotices');
      allNotices.innerHTML = '';
      NOTICES.forEach(n => {
        const it = document.createElement('div');
        it.className = 'notice';
        it.innerHTML = `<div><strong>${escape(n.title)}</strong><div class="small">${escape(n.date)} ‚Äî ${escape(n.text)}</div></div>`;
        allNotices.appendChild(it);
      });
    }

    /* ------------------------
       Profile
       ------------------------ */
    function renderProfile(){
      const user = getStoredUser();
      const name = user ? user.name : 'Convidado';
      const email = user ? user.email : 'sem e-mail';
      document.getElementById('profileName').innerText = name;
      document.getElementById('profileEmail').innerText = email;
      document.getElementById('inputName').value = name || '';
      document.getElementById('inputEmail').value = email || '';
      document.getElementById('profileAvatar').src = (user && user.avatar) ? user.avatar : 'https://via.placeholder.com/200x200?text=Avatar';
    }

    document.getElementById('saveProfileBtn')?.addEventListener('click', () => {
      const name = document.getElementById('inputName').value.trim();
      const email = document.getElementById('inputEmail').value.trim();
      if(!email){ alert('E-mail obrigat√≥rio'); return; }
      const user = getStoredUser() || {};
      user.name = name || user.name || email.split('@')[0];
      user.email = email;
      setStoredUser(user);
      pushActivity({ when: Date.now(), text: 'Perfil atualizado' });
      renderAuthArea();
      renderProfile();
      alert('Perfil salvo (local demo).');
    });

    /* ------------------------
       Attendance and activity
       ------------------------ */
    function markAttendance(sessionId){
      const user = getStoredUser();
      if(!user){ if(!confirm('Voc√™ n√£o est√° logado. Deseja continuar como convidado?')) return; }
      const s = SESSIONS.find(x => x.id === sessionId);
      const now = Date.now();
      pushAttendance({ when: now, sessionId, title: s ? s.title : 'Sess√£o', user: user ? user.email : 'convidado' });
      pushActivity({ when: now, text: `Presen√ßa registrada: ${s ? s.title : sessionId}` });
      renderDashboard();
      renderAttendanceHistory();
      alert('Presen√ßa registrada (demo).');
    }

    function viewSession(id){
      const s = SESSIONS.find(x => x.id === id);
      if(!s) return alert('Sess√£o n√£o encontrada');
      alert(`${s.title}\n${s.time}\nCoach: ${s.coach}`);
    }

    function renderAttendanceHistory(){
      const list = getAttendance();
      const el = document.getElementById('attendanceHistory');
      el.innerHTML = '';
      if(!list.length){ el.innerHTML = '<div class="muted">Nenhuma presen√ßa registrada.</div>'; return; }
      list.slice(0,20).forEach(a => {
        const d = new Date(a.when);
        const row = document.createElement('div');
        row.className = 'small';
        row.innerText = `${d.toLocaleString()} ‚Äî ${a.title || a.sessionId || ''}`;
        el.appendChild(row);
      });
    }

    /* ------------------------
       Utilities
       ------------------------ */
    function escape(str){ return String(str || '').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'})[c]); }
    function toggle(el){ el.classList.toggle('hidden') }

    // small helpers to simulate initial demo state
    (function seedDemo(){
      if(!getStoredUser()){
        // keep guest by default; don't auto-set demo
      }
    })();
  </script>
</body>
  </html>
